<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Passagem de Servi√ßo</title>
<link rel="stylesheet" href="/static/css/styles.css"/>
</head>
<body>
<header class="app-header">
  <img src="/static/assets/logo.png" class="logo" alt="logo"/>
  <div class="titles">
    <h2>PASSAGEM DE SERVI√áO</h2>
    <small id="subTitle">Fiscaliza√ß√£o SUB/OPSUB/MIS</small>
    
  </div>
 <div class="userbox">
      <div class="user-info">
        <span id="userName" class="tag"></span>
        <span id="userProfile" class="profile-admin" style="display:none;">ADMINISTRADOR</span>
      </div>
</div>
</header>
<!--MENU DE NAVEGA√á√ÉO--------------------------------------------------------------------------------------------------->
<nav class="topnav">
  <button class="tablink active" data-tab="consultas">Inicio</button>
  <!--<button class="tablink" data-tab="passagem">Passagem</button>-->
  <button class="tablink" data-tab="cadastros">Cadastros</button>
  <span id="profile" class="msg-prof"></span>
</nav>

<main>
  <section id="tab-consultas" class="tab active">
    <div class="filters fadein">
      <div class="field"><label>In√≠cio</label><input type="date" id="fInicio"></div>
      <div class="field"><label>Fim</label><input type="date" id="fFim"></div>
      <button id="btnBuscar" class="btn">Buscar</button>
      <button id="btnNova" class="btn secondary">Nova PS</button>
      <span id="msgNovaPS" class="msg-erro"></span>
    </div>
    <div class="list-container fadein"><ul id="listaPS"></ul></div>
  </section>
  <!----CABE√áALHO DA PASSAGEM DE SERVI√áO---------------------------------------------------------------------------------->
  <section id="tab-passagem" class="tab">
    <div id="psPlaceholder" class="placeholder">M√ìDULO PASSAGEM DE SERVI√áO</div>
    <div id="psForm" class="psform hidden">
      <div class="ps-header card fadein">
        <div class="row">
          <div class="col"><label>N√∫mero PS</label><input type="text" id="fNumero"></div>
          <div class="col"><label>Data Emiss√£o</label><input type="date" id="fData"></div>
          <div class="col"><label>Embarca√ß√£o</label><input type="text" id="fEmb"></div>
        </div>
        <div class="row">
          <div class="col"><label>Inicio Quinzena</label><input type="date" id="fInicioPS"></div>
          <div class="col"><label>Fim Quinzena</label><input type="date" id="fFimPS"></div>
          <div class="col"><label>Status da PS</label><input type="text" id="fStatus" disabled></div>
        </div>
        <div class="row">
          <div class="col"><label>Fiscal Embarcando</label><select id="fEmbC"><option value="">‚Äî selecione ‚Äî</option></select></div>
          <div class="col"><label>Fiscal Desembarcando</label><input type="text" id="fDesCNome" placeholder="Seu nome completo"></div>
          <div class="col"><label>&nbsp;</label><button id="btnDadosEmb" class="btn small">Dados & Especifica√ß√µes</button></div>
        </div>
        <div class="btns">
          <button id="btnSalvar" class="btn">Salva rascunho</button>
          <button id="btnFinalizar" class="btn">Finalizar (PDF)</button>
          <button id="btnCopiar" class="btn secondary">Copiar para nova (14d)</button>
          <button id="btnExcluirRasc" class="btn secondary">Excluir rascunho</button> <!-- NOVO -->
        </div>
      </div>
      <!-----------------------------------------------SE√á√ïES DA PASSAGEM DE SERVI√áO------------------------------------------------------>
      <div class="tabs-sub">
        <button class="sublink active" data-sub="porto">Porto</button>
        <button class="sublink" data-sub="rotina">Rotina</button>
        <button class="sublink" data-sub="sms">SMS</button>
        <button class="sublink" data-sub="pendencias">Pend√™ncias</button>
        <button class="sublink" data-sub="os">OS</button>
        <button class="sublink" data-sub="gerais">Gerais</button>
        <button class="sublink" data-sub="historico">Hist√≥rico</button>
      </div>


<!---------------SE√á√ÉO PORTO-------------------------------------------------------------------------------------------------------->
<div class="subtab active" id="sub-porto">

<div class="row" style="grid-template-columns:repeat(3,1fr); gap:12px;">  <!-- PRIMEIRA LINHA DE CARDS DA TELA PORTO-->

  <!-- 1.1 Troca de Turma ---------------------------------------------------------------------------------------------------------->
  <div class="card" style="height:100%;">
    <h3>1.1 Troca de Turma</h3>
    <div class="col">
      <label>Porto *</label><input id="ttPorto" type="text" maxlength="100">
      <label>Terminal *</label><input id="ttTerminal" type="text" maxlength="100">
      <label>OS *</label><input id="ttOS" type="text" maxlength="50" style="width:160px;">
      <label>Atraca√ß√£o (hh:mm) *</label><input width="100" id="ttAtracacao" type="time" style="width:100px;">
      <label>Dura√ß√£o (min) *</label><input id="ttDuracao" type="number" step="0.01" min="0" style="width:100px;">
      <label>Observa√ß√µes</label><textarea id="ttObs" maxlength="4000" rows="8" style="width:100%;resize:vertical;overflow:auto;"></textarea>
    </div>
  </div>

  <!-- 1.2 Manuten√ß√£o Preventiva ------------------------------------------------------------------------------------------------------->
  <div class="card" style="height:100%;">
    <h3>1.2 Manuten√ß√£o Preventiva</h3>
    <div class="col">

      
      <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
        <input id="mpNaoPrevisto" type="checkbox">
        N√£o previsto para esse porto
      </label>
      
      <div style="margin-bottom:8px;">
        <label>Franquia solicitada (min)</label>
        <div style="display:flex;align-items:center;gap:8px;flex-wrap:nowrap;">
          <input id="mpFranquia" type="number" step="1" min="0" style="width:160px;">
          <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin:0;">
            <input id="mpNaoSolicitada" type="checkbox"> N√£o solicitada
          </label>
        </div>
      </div>
      
      <div style="margin-bottom:8px;">
        <label>OS</label>
        <div style="display:flex;align-items:center;gap:8px;flex-wrap:nowrap;">
          <input id="mpOS" type="text" maxlength="50" style="width:160px;">
          <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin:0;">
            <input id="mpNaoProgramada" type="checkbox"> N√£o programada
          </label>
        </div>
      </div>

      <label>Saldo de franquia (min)</label>
      <input id="mpSaldo" type="number" step="1" min="0"style="width:100px;">

      <label>RADE (anexo)</label>
      <input id="mpRADE" type="file" accept="application/pdf,image/*">

      <label>Observa√ß√µes</label>
      <textarea id="mpObs" maxlength="4000" rows="8" style="width:100%;resize:vertical;overflow:auto;"></textarea>
    </div>
  </div>

  <!-- 1.3 Abastecimento ---------------------------------------------------------------------------------------------------------->
  <div class="card" style="height:100%;">
    <h3>1.3 Abastecimento</h3>
    <div class="col">
      <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
        <input id="abNaoPrevisto" type="checkbox"> N√£o previsto para esse porto
      </label>
      <label>OS</label><input id="abOS" type="text" maxlength="50" style="width:160px;">
      <label>Quantidade (m¬≥)</label><input id="abQtd" type="number" step="1" min="0" style="width:100px;">
      <label>Dura√ß√£o (min)</label><input id="abDuracao" type="number" step="1" min="0" style="width:100px;">
      <label>Anexo</label><input id="abAnexo" type="file">
      <label>Observa√ß√µes</label><textarea id="abObs" maxlength="4000" rows="8" style="width:100%;resize:vertical;overflow:auto;"></textarea>
    </div>
  </div>

</div>
<div class="row" style="grid-template-columns:repeat(3,1fr); gap:12px;"><!-- SEGUNDA LINHA DE CARDS DA TELA PORTO-->

  <!-- 1.4 Inspe√ß√£o ANVISA --------------------------------------------------------------------------------------------------------->
  <div class="card" style="height:100%;">
    <h3>1.4 Inspe√ß√£o ANVISA</h3>
    <div class="col">
      <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
        <input id="anNaoPrevisto" type="checkbox"> N√£o previsto para esse porto
      </label>
      <label>OS</label>
      <input id="anOS" type="text" maxlength="50" style="width:160px;">
      <label>Descri√ß√£o</label>
      <input id="anDesc" type="text" maxlength="500">
      <label>Observa√ß√µes</label>
<textarea id="anObs" maxlength="4000" rows="8" style="width:100%;resize:vertical;overflow:auto;"></textarea>

    </div>
  </div>

  <!-- 1.5 Inspe√ß√£o de Classe ------------------------------------------------------------------------------------------------->
  <div class="card" style="height:100%;">
    <h3>1.5 Inspe√ß√£o de Classe</h3>
    <div class="col">
      <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
        <input id="clNaoPrevisto" type="checkbox"> N√£o previsto para esse porto
      </label>
      <label>OS</label>
      <input id="clOS" type="text" maxlength="50" style="width:160px;">
      <label>Descri√ß√£o</label>
      <input id="clDesc" type="text" maxlength="500">
      <label>Observa√ß√µes</label>
      <textarea id="clObs" maxlength="4000" rows="8" style="width:100%;resize:vertical;overflow:auto;"></textarea>

    </div>
  </div>

  <!-- 1.6 Inspe√ß√µes/Auditorias Petrobras -->
  <div class="card" style="height:100%;">
    <h3>1.6 Inspe√ß√µes/Auditorias Petrobras</h3>
    <div class="col">
      <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
        <input id="ipNaoPrevisto" type="checkbox"> N√£o previsto para esse porto
      </label>
      <label>Auditor</label>
      <input id="ipAud" type="text" maxlength="200">
      <label>Ger√™ncia</label>
      <input id="ipGer" type="text" maxlength="200">
      <label>Observa√ß√µes</label>
      <textarea id="ipObs" maxlength="4000" rows="8" style="width:100%;resize:vertical;overflow:auto;"></textarea>
    </div>
  </div>

</div>


<div class="row" style="grid-template-columns:repeat(3,1fr); gap:12px;"><!-- TERCEIRA LINHA DE CARDS DA TELA PORTO -->

  <!-- 1.7 Embarque de Equipes (lista) -->
  <div class="card" style="height:100%;">
    <h3>1.7 Embarque de Equipes</h3>
    <div class="col">
      <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
        <input id="eqNaoPrevisto" type="checkbox"> N√£o previsto para esse porto
      </label>
    </div>
    <table id="tblEq">
      <thead><tr><th>Descri√ß√£o</th><th>Empresa</th><th>Nome</th><th>Observa√ß√µes</th><th></th></tr></thead>
      <tbody></tbody>
    </table>
    <div class="row">
      <div class="col"><button id="btnAddEq" class="btn secondary">Adicionar linha</button></div>
    </div>
  </div>

  <!-- 1.8 Embarque de Materiais (lista) -->
  <div class="card" style="height:100%;">
    <h3>1.8 Embarque de Materiais</h3>
    <div class="col">
      <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
        <input id="emNaoPrevisto" type="checkbox"> N√£o previsto para esse porto
      </label>
    </div>
    <table id="tblEM">
      <thead><tr><th>Origem</th><th>OS</th><th>Destino</th><th>RT</th><th>Observa√ß√µes</th><th>Anexo</th><th></th></tr></thead>
      <tbody></tbody>
    </table>
    <div class="row">
      <div class="col"><button id="btnAddEM" class="btn secondary">Adicionar linha</button></div>
    </div>
  </div>

  <!-- 1.9 Desembarque de Materiais (lista) -->
  <div class="card" style="height:100%;">
    <h3>1.9 Desembarque de Materiais</h3>
    <div class="col">
      <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
        <input id="dmNaoPrevisto" type="checkbox"> N√£o previsto para esse porto
      </label>
    </div>
    <table id="tblDM">
      <thead><tr><th>OS</th><th>Origem</th><th>Destino</th><th>RT</th><th>Observa√ß√µes</th><th>Anexo</th><th></th></tr></thead>
      <tbody></tbody>
    </table>
    <div class="row">
      <div class="col"><button id="btnAddDM" class="btn secondary">Adicionar linha</button></div>
    </div>
  </div>

</div>

<!-- QUARTA LINHA DE CARDS DA TELA PORTO -->
<div class="row" style="grid-template-columns:repeat(3,1fr); gap:12px;">

  <!-- 1.10 OS Mobiliza√ß√£o/Desmobiliza√ß√£o (lista) -->
  <div class="card" style="height:100%;">
    <h3>1.10 OS Mobiliza√ß√£o/Desmobiliza√ß√£o</h3>
    <div class="col">
      <label style="display:inline-flex;align-items:center;gap:6px;white-space:nowrap;margin-bottom:8px;">
        <input id="omNaoPrevisto" type="checkbox"> N√£o previsto para esse porto
      </label>
    </div>
    <table id="tblOM">
      <thead>
        <tr><th>OS</th><th>Descri√ß√£o</th><th>Observa√ß√µes</th><th>Anexo</th><th></th></tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="row">
      <div class="col"><button id="btnAddOM" class="btn secondary">Adicionar linha</button></div>
    </div>
  </div>


</div>
</div> <!-- FIM DA SE√á√ÉO PORTO -->


      <!---------------SE√á√ÉO ROTINA-------------------------------------------------------------------------------------------------------->
      <div class="subtab" id="sub-rotina"><div class="card"><h3>Rotina ‚Äì campos prontos</h3></div></div>




      <!---------------SE√á√ÉO SMS-------------------------------------------------------------------------------------------------------->
      <div class="subtab" id="sub-sms"><div class="card"><h3>SMS ‚Äì campos prontos</h3></div></div>




      <!---------------SE√á√ÉO PENDENCIAS-------------------------------------------------------------------------------------------------------->
      <div class="subtab" id="sub-pendencias"><div class="card"><h3>Pend√™ncias ‚Äì campos prontos</h3></div></div>



      <!---------------SE√á√ÉO ORDENS DE SERVI√áO-------------------------------------------------------------------------------------------------------->
      <div class="subtab" id="sub-os"><div class="card"><h3>OS ‚Äì campos prontos</h3></div></div>




      <!---------------SE√á√ÉO INFORMA√á√ïES GERAIS-------------------------------------------------------------------------------------------------------->
      <div class="subtab" id="sub-gerais"><div class="card"><h3>Gerais ‚Äì campos prontos</h3></div></div>





      <!---------------SE√á√ÉO LOG-------------------------------------------------------------------------------------------------------->
      <div class="subtab" id="sub-historico"><div class="card"><h3>Hist√≥rico ‚Äì (AuditLog no back)</h3></div></div>
    </div>
  </section>





  <!---------------CADASTROS  ADM-------------------------------------------------------------------------------------------------------->
 <section id="tab-cadastros" class="tab">
  <div class="accordion">
    
    <!-- ========== ACCORDION ITEM: FISCAIS ========== -->
    <div class="accordion-item">
      <div class="accordion-header" data-target="fiscais">
        <h3>üìã Fiscais</h3>
        <span class="toggle">‚ñº</span>
      </div>
      <div class="accordion-content active" id="acc-fiscais">
        <div class="card fadein">
          <div class="col"><label>Chave</label><input id="cad_f_ch" type="text" maxlength="4" style="width:80px"></div>
          <div class="col"><label>Nome</label><input id="cad_f_nome" type="text" style="width:400px"></div>
          <div class="col"><label>Celular</label><input id="cad_f_celular" type="text" maxlength="15" style="width:180px"></div>
          <div class="col"><label>E-mail</label><input id="cad_f_email" type="email" style="width:300px"></div>
          <div class="col" style="display:flex; gap:16px; align-items:center; margin-top:8px">
            <label style="display:inline-flex; align-items:center; gap:6px">
              <input id="cad_f_perfFisc" type="checkbox"> Perfil Fiscal
            </label>
            <label style="display:inline-flex; align-items:center; gap:6px">
              <input id="cad_f_perfAdm" type="checkbox"> Perfil ADM
            </label>
          </div>
          <div class="row" style="align-items:flex-end; gap:8px; margin-top:8px">
            <div class="col" style="min-width:300px">
              <label>Fiscais cadastrados</label>
              <select id="cad_f_list"><option value="">‚Äî selecione ‚Äî</option></select>
            </div>
            <div class="col" style="flex:0 0 auto; display:flex; gap:8px">
              <button id="btnSaveFiscal" class="btn ghost">Salvar</button>
              <button id="btnFiscalEditar" class="btn ghost" disabled>Editar</button>
              <button id="btnFiscalExcluir" class="btn ghost" disabled>Excluir</button>
              <div class="col" id="fiscEditActions" style="flex:0 0 auto; display:none; gap:8px">
                <button id="btnFiscalConfirma" class="btn">Confirmar</button>
                <button id="btnFiscalCancela" class="btn ghost">Cancelar</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- ========== FIM: FISCAIS ========== -->

    <!-- ========== ACCORDION ITEM: EMBARCA√á√ïES ========== -->
    <div class="accordion-item">
      <div class="accordion-header" data-target="embarcacoes">
        <h3>üö¢ Embarca√ß√µes</h3>
        <span class="toggle">‚ñº</span>
      </div>
      <div class="accordion-content" id="acc-embarcacoes">
        <div class="card fadein">
          <div class="col">
            <label>Tipo</label>
            <select id="cad_e_tipo" style="width:200px"><option value="">‚Äî selecione ‚Äî</option></select>
          </div>
          <div class="col"><label>Nome</label><input id="cad_e_nome" type="text" style="width:400px"></div>
          <div class="col">
            <label>Modal</label>
            <select id="cad_e_modal" style="width:200px"><option value="">‚Äî selecione ‚Äî</option></select>
          </div>
          <div class="col"><label>Primeiro Porto</label><input id="cad_e_primeira" type="date" style="width:200px"></div>
          <div class="col"><label>E-mail Petrobras</label><input id="cad_e_email" type="email" style="width:300px"></div>
          <div class="col"><label>Empresa Navega√ß√£o</label><input id="cad_e_emprNav" type="text" style="width:300px"></div>
          <div class="col"><label>ICJ Empresa Navega√ß√£o</label><input id="cad_e_icjEmprNav" type="text" maxlength="20" style="width:200px"></div>
          <div class="col"><label>Empresa Servi√ßo</label><input id="cad_e_emprServ" type="text" style="width:300px"></div>
          <div class="col"><label>ICJ Empresa Servi√ßo</label><input id="cad_e_icjEmprServ" type="text" maxlength="20" style="width:200px"></div>
          <div class="row" style="align-items:flex-end; gap:8px; margin-top:8px">   
            <div class="col" style="min-width:300px">
              <label>Embarca√ß√µes cadastradas</label>
              <select id="cad_e_list"><option value="">‚Äî selecione ‚Äî</option></select>
            </div>
            <div class="col" style="flex:0 0 auto; display:flex; gap:8px">
              <button id="btnSaveEmb" class="btn ghost">Salvar</button>
              <button id="btnEmbEditar" class="btn ghost" disabled>Editar</button>
              <button id="btnEmbExcluir" class="btn ghost" disabled>Excluir</button>
              <div class="col" id="embEditActions" style="flex:0 0 auto; display:none; gap:8px">
                <button id="btnEmbConfirma" class="btn">Confirmar</button>
                <button id="btnEmbCancela" class="btn ghost">Cancelar</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- ========== FIM: EMBARCA√á√ïES ========== -->

    <!-- ========== ACCORDION ITEM: PASSAGENS DE SERVI√áO (ADM) ========== -->
    <div class="accordion-item">
      <div class="accordion-header" data-target="passagens">
        <h3>üìÑ Passagens de Servi√ßo</h3>
        <span class="toggle">‚ñº</span>
      </div>
      <div class="accordion-content" id="acc-passagens">
        <div class="card fadein">
          <div class="row" style="align-items:flex-end; gap:8px">
            <div class="col" style="min-width:340px">
              <label>Passagens de Servi√ßo (todas)</label>
              <select id="admin_ps_list">
                <option value="">‚Äî selecione ‚Äî</option>
              </select>
              <div class="muted" id="admin_ps_hint" style="margin-top:6px">Selecione uma PS para poder excluir.</div>
            </div>
            <div class="col" style="flex:0 0 auto">
              <button id="btnAdminPSDelete" class="btn ghost" disabled>Excluir</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- ========== FIM: PASSAGENS DE SERVI√áO ========== -->

    <!-- ========== PARA ADICIONAR NOVO CARD ========== 
    <div class="accordion-item">
      <div class="accordion-header" data-target="NOME_DO_TARGET">
        <h3>üîß T√≠tulo do Card</h3>
        <span class="toggle">‚ñº</span>
      </div>
      <div class="accordion-content" id="acc-NOME_DO_TARGET">
        <div class="card fadein">
          CONTE√öDO DO CARD AQUI
        </div>
      </div>
    </div>
    ========== FIM DO TEMPLATE ========== -->

  </div>
</section>

  <!-- Modal: Selecionar Embarca√ß√£o para Nova PS ------------------------------------------------------------------------------>
<div id="modalNovaPS" class="modal hidden" aria-hidden="true">
  <div class="modal-content">
    <h3>Selecionar embarca√ß√£o</h3>

    <div class="field">
      <label for="selEmbNova">Embarca√ß√£o</label>
      <select id="selEmbNova">
        <option value="">‚Äî selecione ‚Äî</option>
        <!-- op√ß√µes ser√£o preenchidas via app.js (EMB) -->
      </select>
    </div>

    <div class="btns" style="margin-top:8px">
      <button id="btnModalNovaConfirmar" class="btn" disabled>Confirmar</button>
      <button id="btnModalNovaCancelar" class="btn secondary" type="button">Cancelar</button>
    </div>

    <div id="msgModalNovaPS" class="msg-erro"></div>
  </div>
</div>

</main>

<div id="loginModal" class="modal hidden">
  <div class="modal-content">
    <h3>Identifica√ß√£o</h3>
    <p>Digite seu <strong>nome completo</strong> exatamente como cadastrado na lista de Fiscais.</p>
    <input id="loginNome" type="text" placeholder="Seu nome completo"/>
    <div class="btns"><button id="btnLogin" class="btn">Entrar</button></div>
    <div id="loginMsg" class="msg"></div>
  </div>
</div>

<!-- === M√ìDULOS IMPLEMENTADOS === -->
<!-- Autentica√ß√£o -->

<!-- Cadastros -->


<!-- === AUTENTICA√á√ÉO E MODULO GERENCIADOR === -->
 <script src="/static/js/auth.js"></script>
 <script src="/static/js/fiscais.js"></script>
 <script src="/static/js/embarcacoes.js"></script> 
 <script src="/static/js/app.js"></script>
</body>
</html>
